/*! @2015 Leo Wang. All Rights Reserved */
void function(e){e("promise/Promise",["require","./util","./PromiseCapacity"],function(require){function e(r){if("function"!=typeof r)throw new TypeError("Promise resolver undefined is not a function");if(!(this instanceof e))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");var i=new t(this);this.then=n.bind(i.then,i),r(n.bind(i.resolve,i),n.bind(i.reject,i))}var n=require("./util"),t=require("./PromiseCapacity");return e.prototype.then=function(){},e.prototype["catch"]=function(e){return this.then(null,e)},e.resolve=function(n){return new e(function(e){e(n)})},e.reject=function(n){return new e(function(e,t){t(n)})},e.all=function(e){var t=this;if(!n.isArray(e))throw new TypeError("You must pass an array to all.");return new t(function(t,r){function i(e){return function(n){o(e,n)}}function o(e,n){if(a[e]=n,0===--u)t(a)}var a=[],u=e.length,l=null;if(0===u)t([]);for(var c=0,f=e.length;f>c;c++){l=e[c];var s=n.getThen(l);if("function"==typeof s)l.then(i(c),r);else o(c,l)}})},e.race=function(e){var t=this;if(!n.isArray(e))throw new TypeError("You must pass an array to race.");return new t(function(t,r){for(var i=0,o=e.length;o>i;i++){var a=e[i],u=n.getThen(a);if("function"==typeof u)u.call(a,t,r);else t(a)}})},e})}("function"==typeof define&&define.amd?define:function(e){module.exports=e(require)},this);